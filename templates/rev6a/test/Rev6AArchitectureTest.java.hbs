package {{rootPackage}};

import com.tngtech.archunit.core.domain.JavaClasses;
import com.tngtech.archunit.core.importer.ClassFileImporter;
import com.tngtech.archunit.library.dependencies.SlicesRuleDefinition;
import org.junit.jupiter.api.Test;

import static com.tngtech.archunit.lang.syntax.ArchRuleDefinition.noClasses;

class Rev6AArchitectureTest {

  private final JavaClasses classes = new ClassFileImporter().importPackages("{{rootPackage}}");

  @Test
  void shared_must_not_depend_on_modules() {
    noClasses()
        .that().resideInAPackage("..shared..")
        .should().dependOnClassesThat().resideInAPackage("..module..")
        .check(classes);
  }

  @Test
  void usecases_must_not_depend_on_each_other() {
    SlicesRuleDefinition.slices()
        .matching("..module.(*)..(*usecase)..")
        .should().notDependOnEachOther()
        .check(classes);
  }

  @Test
  void domain_and_application_must_not_depend_on_infrastructure() {
    noClasses()
        .that().resideInAnyPackage("..domain..", "..application..")
        .should().dependOnClassesThat().resideInAPackage("..infrastructure..")
        .check(classes);
  }
}

