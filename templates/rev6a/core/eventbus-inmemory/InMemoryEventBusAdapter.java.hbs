package {{corePackage}}.infrastructure.eventbus.inmemory;

import {{corePackage}}.contract.event.EventEnvelope;
import {{corePackage}}.contract.event.EventPublisherPort;
import io.smallrye.mutiny.Uni;
import jakarta.enterprise.context.ApplicationScoped;
import java.util.Queue;
import java.util.concurrent.ConcurrentLinkedQueue;

@ApplicationScoped
public class InMemoryEventBusAdapter implements EventPublisherPort {
  private static final Queue<EventEnvelope> BUS = new ConcurrentLinkedQueue<>();

  @Override
  public Uni<Void> publish(EventEnvelope envelope) {
    BUS.add(envelope);
    return Uni.createFrom().voidItem();
  }
}

